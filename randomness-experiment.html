<!doctype html>
<html>

<head>
    <title>Randomness experiment</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script src="jspsych-5.0.3/jspsych.js"></script>
    <script src="jspsych-5.0.3/plugins/jspsych-text.js"></script>
    <script src="jspsych-5.0.3/plugins/jspsych-instructions.js"></script>
    <script src="jspsych-5.0.3/plugins/jspsych-single-stim.js"></script>
    <script src="jspsych-5.0.3/plugins/jspsych-multi-stim-multi-response.js"></script>
    <script src="jspsych-5.0.3/plugins/jspsych-html.js"></script>
    <link href="jspsych-5.0.3/css/jspsych.css" rel="stylesheet" type="text/css"></link>
</head>

<body>
</body>
<script>
// generate a random 15-character string for subject ID
var subject_id = jsPsych.randomization.randomID(15);

//pick a random condition for the subject at the start of the experiment
var condition = jsPsych.randomization.sample(['aware_predict', 'unaware_predict', 'unaware_no_predict'], 1);

//extra data to be added to each trial
jsPsych.data.addProperties({
    subject: subject_id,
    condition: condition
});

//function to check for participant consent.
var check_consent = function(elem) {
    if ($('#consent_checkbox').is(':checked')) {
        return true;
    } else {
        alert("If you wish to participate, you must check the box next to the statement 'I agree to participate in this study.'");
        return false;
    }
    return false;
};

// declare consent block.
var consent_block = {
    type: 'html',
    url: "consent_page.html",
    cont_btn: "start",
    check_fn: check_consent
};

//define welcome message block (overview of experiment)
var welcome_block = {
    type: 'instructions',
    pages: [
        '<strong>Welcome to the experiment</strong> ' +
        '<br />In the <strong>first</strong> part of the experiment, you are asked to create a sequence of Rock, Paper, Scissors that is as random as possible.' +
        '<ul><li>   For Rock: press the letter "g" on the keyboard.' +
        '<li>       For Paper: press the letter "h" on the keyboard. ' +
        '<li>       For Scissors: press the letter "b" on the keyboard. </ul>' +
        'Please take a moment to locate these keys on your keyboard now and to remember the mapping of letters to rock, paper, and scissors. ' +
        '<p>At the beginning of each trial, you will see a 3-2-1 countdown on the screen, followed by a red "GO!" signal. ' +
        'You must press "g", "h", or "b" as soon as you see the go signal. You will only have half a second to enter your response. ' +
        'Most importantly, <em>please make a conscious effort to create a series of Rock, Paper and Scissors that is as random as possible. </em>' +
        'It might help you to visualize this task as casting a 3-faced die. You can also try to imagine a computer program that spits out "Rock!", "Paper!" or "Scissors!" at random, in an unpredictable fashion.' +
        'The 10 first trials will serve as practice, for you to get accustomed to the experimental environment. Then you will begin your random sequence generation. </p>' +
        '<p>In the <strong>second</strong> part of the experiment, you will play rounds of Rock-Paper-Scissors against the computer. Your goal is to win as many rounds as possible. Once again, you will have the three natural options "Rock", "Paper" and "Scissors" to choose from, which you will select by pressing the same keys as in part 1. </p>' +
        'Reminder: Rock beats Scissors, Scissors beat Paper, and Paper beats Rock. ' +
        'The winner of the game will be determined by the amount of points you end up with. Both yourself and the computer will be allotted 100 points before starting the game. You will both obtain or lose points in the following manner:' +
        '<ul><li>You win: you receive 1 point, and the computer loses 1 point.' +
        '<li>You tie: both scores remain the same' +
        '<li>You lose: you lose 1 point, and the computer receives 1 point. </ul>' +
        'This means that if you lose a round (example: you play Paper and the computer plays Scissors), not only will you lose a point but the computer will gain one. ' +
        'Again, you will see the 3-2-1 countdown and the red "GO!" appear on the screen. If you do not press one of the keys (G, H or B) within a half second of the red "GO!" appearing, you will lose one point but the computer will not gain a point. ' +
        '<p>The <strong>third</strong> part of the experiment will be exactly the same as the first part: you will again generate a sequence of Rock, Paper and Scissors that is as random and unpredictable as possible. To help you picture this once more, you can imagine that your iPod only contains three songs titled "Rock", "Paper" and "Scissors", and you hit the Shuffle button repeatedly so that the iPod chooses one of the songs at random each time. It is crucial in these two parts that you literally try to act like your iPod, or the die, or the computer algorithm and make your sequence completely random. </p>'
    ],
    show_clickable_nav: true
};

//define instructions block for Part 1
var instructions_block1 = {
    type: 'instructions',
    pages: [
        'Welcome to Part <strong>ONE</strong> of the game. ' +
        '<br />Please generate a random sequence of 3 events "Rock", "Paper" and "Scissors". ' +
        '<br />You are asked to press the 3 buttons (G,H, or B) as randomly as possible. ' +
        '<br />(Note that: the "g" key represents "Rock", the "h" key represents "Paper", and the "b" key represents "Scissors". ' +
        '<br />We will begin with a practise round. Press "next" when you are ready. ',

        '<strong> PRACTISE BLOCK </strong>'
    ],
    show_clickable_nav: true
};

//define instructions block for Part 2a (aware_predict)
var instructions_block2a = {
    type: 'instructions',
    pages: [
        'This is now part <strong>TWO</strong> of the experiment',
        'You will be predicted...this is condition 2a',
        'GL and begin'
    ],
    show_clickable_nav: true
};

//define instructions block for Part 2b (unaware_predict)
var instructions_block2b = {
    type: 'instructions',
    pages: [
        'This is now part <strong>TWO</strong> of the experiment',
        'You will be predicted (but not told)...this is condition 2b',
        'GL and begin'
    ],
    show_clickable_nav: true
};

//define instructions block for Part 2c (unaware_no_predict)
var instructions_block2c = {
    type: 'instructions',
    pages: [
        'This is now part <strong>TWO</strong> of the experiment',
        'You will NOT be predicted...this is condition 2c',
        'GL and begin'
    ],
    show_clickable_nav: true
};


//define instructions block for Part 3
var instructions_block3 = {
    type: 'instructions',
    pages: [
        'Welcome to Part <strong>THREE</strong> of the game. ' +
        '<br />Please generate a random sequence of 3 events "Rock", "Paper" and "Scissors". ' +
        '<br />You are asked to press the 3 buttons (G,H, or B) as randomly as possible. ' +
        '<br />(Note that: the "g" key represents "Rock", the "h" key represents "Paper", and the "b" key represents "Scissors". '
    ],
    show_clickable_nav: true
};

var debrief_block = {
    type: "text",
    text: function() {
        var subject_data = getSubjectData();
        return "<p>DEBRIEF TEXT GOES HERE</p>";
    }
};

/* define countdown trial slow ver for practise*/
var countdown_trial_practise = {
    type: 'multi-stim-multi-response',
    stimuli: ['3', '2', '1'],
    is_html: true,
    timing_stim: [600, 600, 600],
    choices: [], //71 = g = rock, 72 = h = paper, 66 = b = scissors 
    prompt: 'Press "g" for Rock, "h" for Paper or "b" for Scissors at the GO',
    timing_response: 1800,
    response_ends_trial: false,
    data: {
        part_num: '0',
        block_task: 'practise_rand_seq_gen'
    }
};

/* define countdown trial fast ver, part 1*/
var countdown_trial_part1 = {
    type: 'multi-stim-multi-response',
    stimuli: ['3', '2', '1'],
    is_html: true,
    timing_stim: [500, 500, 500],
    choices: [], //71 = g = rock, 72 = h = paper, 66 = b = scissors 
    prompt: 'Press "g" for Rock, "h" for Paper or "b" for Scissors at the GO',
    timing_response: 1500,
    response_ends_trial: false,
    data: {
        part_num: '1',
        block_task: 'rand_seq_gen'
    }
};

/* define countdown trial for part 2*/
var countdown_trial_part2 = {
    type: 'multi-stim-multi-response',
    stimuli: ['3', '2', '1'],
    is_html: true,
    timing_stim: [300, 300, 300],
    choices: [], //71 = g = rock, 72 = h = paper, 66 = b = scissors 
    prompt: 'Press "g" for Rock, "h" for Paper or "b" for Scissors',
    timing_response: 900,
    response_ends_trial: false,
    data: {
        part_num: '2',
        block_task: 'game_rand_seq'
    }
};

/* define countdown trial for part 3*/
var countdown_trial_part3 = {
    type: 'multi-stim-multi-response',
    stimuli: ['3', '2', '1'],
    is_html: true,
    timing_stim: [300, 300, 300],
    choices: [], //71 = g = rock, 72 = h = paper, 66 = b = scissors 
    prompt: 'Press "g" for Rock, "h" for Paper or "b" for Scissors',
    timing_response: 900,
    response_ends_trial: false,
    data: {
        part_num: '3',
        block_task: 'rand_seq_gen'
    }
};

var go_trial = {
    type: 'single-stim',
    is_html: true,
    stimulus: '<p>Go!</p>',
    timing_response: 500,
    response_ends_trial: true,
    choices: ['g', 'h', 'b'], //71 = g = rock, 72 = h = paper, 66 = b = scissors 
    data: {
        answer_status: 'answered'
    }
}; //end var go_trial

/* create experiment definition array */
var timeline = [];

timeline.push(consent_block, welcome_block);
timeline.push(instructions_block1);

/* PRACTISE BLOCK */
for (var i = 0; i < 5; i++) {
    timeline.push(loop_node);
};

/* PART 1*/
for (var i = 0; i < 5; i++) {
    timeline.push(countdown_trial_part1, go_trial);
};

/* Display appropriate instructions */
if (condition == 'aware') {
    timeline.push(instructions_block2a); //a= aware+predict 
} else if (condition == 'unaware_predict') {
    timeline.push(instructions_block2b); //b= unaware+predict
} else if (condition == 'unaware_no_predict') {
    timeline.push(instructions_block2c); //b= unaware+no predict
};

/* PART 2 */
for (var i = 0; i < 5; i++) {
    timeline.push(countdown_trial_part2, go_trial);
};

/* PART 3 */
timeline.push(instructions_block3);
for (var i = 0; i < 5; i++) {
    timeline.push(countdown_trial_part3, go_trial);
};

/* DEBRIEF */
timeline.push(debrief_block);

/* start the experiment */ jsPsych.init({ timeline: timeline, on_finish: function() { jsPsych.data.displayData('json'); }, //display data at end of exp default_iti: 100 });
</script>

</html>

